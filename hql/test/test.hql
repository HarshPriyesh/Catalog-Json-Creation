CREATE DATABASE consumption_rf_3_insfin_verona_mpf;
CREATE TABLE IF NOT EXISTS `consumption_rf_3_insfin_verona_mpf.cv_cashentries`(
   `loadflag` char(1),
   `sourcesystemid` tinyint,
   `cashentryid` int,
   `standingcashentryid` int,
   `subaccountid` varchar(20),
   `batchid` int,
   `transferrequestid` int,
   `type` varchar(20),
   `subtype` varchar(20),
   `instructiontype` varchar(20),
   `method` varchar(25),
   `status` varchar(30),
   `ccycode` char(3),
   `chequereference` varchar(50),
   `contributiongroup` varchar(20),
   `contributionsource` varchar(50),
   `excludefromsublimit` tinyint,
   `isasubscriptiondate` decimal(8,0),
   `statusnote` varchar(255),
   `amount` decimal(19,4),
   `settledamount` decimal(19,4),
   `datecreated` decimal(8,0),
   `datecancelled` decimal(8,0),
   `datecompleted` decimal(8,0),
   `frequency` varchar(20),
   `lastmodified` decimal(14,0),
   `firstdate` decimal(8,0),
   `paymentsubtype` varchar(50),
   `targetsubaccountid` varchar(20),
   `sipppaymenttype` varchar(7),
   `transactionid` int,
   `taxtype` varchar(50),
   `narration` varchar(500),
   `nextpaydate` decimal(8,0),
   `wizardid` int,
   `advicegiven` tinyint,
   `advicetype` varchar(50),
   `wrapinitialchargemethod` varchar(50),
   `wrapinitialchargevalue` decimal(18,4),
   `initialchargemethod` varchar(50),
   `initialchargevalue` decimal(18,4),
   `usercreatedid` int,
   `sortcode` varchar(30),
   `sourceofwealth` varchar(40),
   `incomebeforetax` decimal(18,2),
   `occupation` varchar(50),
   `regularcrystallisationtype` varchar(32),
   `isincomerequirednet` tinyint,
   `cancelleduserid` int,
   `isfullwithdrawal` tinyint,
   `corporateisemployeecontribution` tinyint,
   `corporateisemployercontribution` tinyint,
   `corporateisadditionalvoluntarycontribution` tinyint,
   `corporateissinglecontribution` tinyint,
   `corporateisregularcontribution` tinyint,
   `taxamount` decimal(18,2),
   `immediatetaxfreecashrequestid` int,
   `regularcrystallisationid` int,
   `confirmeddate` int,
   `placeddate` int,
   `authoriseddate` int,
   `journalleddate` int,
   `pooledcashexpectationid` int,
   `ispoolexpectation` tinyint,
   `paymenttype` varchar(20),
   `displayinstruction` varchar(255),
   `edh_ingest_ts` timestamp,
   `edh_ingest_delete_flag` boolean,
   `edh_source_extract_ts` timestamp,
   `edh_brand_id` string,
   `edh_ingest_map` string)
 PARTITIONED BY (
   `ingestion_year` int,
   `ingestion_month` int,
   `ingestion_day` int)
STORED AS ORC;

CREATE TABLE IF NOT EXISTS `consumption_rf_3_insfin_verona_mpf.cv_tierediscbyschemeHarshPriyesh`(
   `loadflag` char(1),
   `sourcesystemid` tinyint,
   `tierediscbyschemeid` int,
   `tierboundaryid` smallint,
   `schemeid` int,
   `subaccounttype` varchar(20),
   `arrangementtype` varchar(20),
   `instrumentid` int,
   `isactive` tinyint,
   `fromdate` int,
   `todate` int,
   `lowerlimit` decimal(19,2),
   `upperlimit` decimal(19,2),
   `rate` decimal(7,4),
   `edh_ingest_ts` timestamp,
   `edh_ingest_delete_flag` boolean,
   `edh_source_extract_ts` timestamp,
   `edh_brand_id` string,
   `edh_ingest_map` string)
 PARTITIONED BY (
   `ingestion_year` int,
   `ingestion_month` int,
   `ingestion_day` int)
STORED AS ORC;
